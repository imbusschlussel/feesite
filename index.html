<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Finder's Fee</title>
    <link rel="icon" href="./favicon.ico" type="image/x-icon" />
    <style>
      #image {
        width: 30%;
        cursor: pointer;
        z-index: 0;
      }

      body {
        font-family: Helvetica, Arial, sans-serif;
        width: 100vh;
        height: 100vw;
        margin: 0;
        padding: 0;
        overflow: hidden;
        position: relative;
      }

      nav ul {
        list-style: none;
        display: flex;
        position: absolute;
        top: 4px;
        left: 4px;
      }

      nav ul li {
        font-weight: 500;
        font-size: 0.75rem;
        margin-right: 8px;
      }

      a {
        cursor: pointer !important;
        pointer-events: auto;
        text-decoration: none;
        color: black;
        z-index: 10;
      }

      a:hover {
        color: #dbd7c4;
      }
    </style>
  </head>
  <body>
    <nav>
      <ul>
        <li>
          <a href="https://feesite.vercel.app/" target="_blank" rel="noreferrer noopener nofollow">reload</a>
        </li>
        <li>
          <a href="https://instagram.com/findersfeerecs" target="_blank" rel="noreferrer noopener nofollow">instagram</a>
        </li>
        <li>
          <a href="https://findersfee.bandcamp.com/" target="_blank" rel="noreferrer noopener nofollow">bandcamp</a>
        </li>
      </ul>
    </nav>
    <img id="image" src="cover.webp" alt="Album Cover FEE004" onclick="play()" />
    <audio id="audio" src="./atf_tfop.mp3"></audio>

    <script>
      function play() {
        const audioElement = document.querySelector("#audio");
        if (!audioElement.paused) {
          audioElement.pause();
          return;
        }
        audioElement.play();
      }

      const image = document.getElementById("image");
      let posX = 100;
      let posY = 100;
      let velocityX;
      let velocityY;

      const isMobile = /Mobi|Android/i.test(navigator.userAgent); // detect mobile
      const randomnessScale = isMobile ? 0.02 : 0.015; // mobile gets more turbulence
      const nudgeChance = isMobile ? 0.15 : 0.1; // more frequent nudging on mobile
      const maxSpeed = 0.1;

      function setVelocity() {
        const baseSpeed = isMobile ? 15 : 30;
        const dirX = Math.sign(velocityX || 1);
        const dirY = Math.sign(velocityY || 1);
        const speedX = baseSpeed / window.innerWidth;
        const speedY = baseSpeed / window.innerHeight;
        velocityX = dirX * 3 * speedX;
        velocityY = dirY * 3 * speedY;
      }

      setVelocity();

      function updatePosition() {
        const imageRect = image.getBoundingClientRect();
        const windowWidth = window.innerWidth;
        const windowHeight = window.innerHeight;

        // Occasionally nudge with turbulence
        if (Math.random() < nudgeChance) {
          velocityX += (Math.random() - 0.5) * randomnessScale;
          velocityY += (Math.random() - 0.5) * randomnessScale;

          velocityX = Math.max(-maxSpeed, Math.min(maxSpeed, velocityX));
          velocityY = Math.max(-maxSpeed, Math.min(maxSpeed, velocityY));
        }

        posX += velocityX * 3;
        posY += velocityY * 3;

        if (posX + imageRect.width >= windowWidth || posX <= 0) {
          velocityX *= -1;
          posX = Math.max(0, Math.min(posX, windowWidth - imageRect.width));
        }

        if (posY + imageRect.height >= windowHeight || posY <= 0) {
          velocityY *= -1;
          posY = Math.max(0, Math.min(posY, windowHeight - imageRect.height));
        }

        image.style.transform = `translate(${posX}px, ${posY}px)`;
        requestAnimationFrame(updatePosition);
      }

      window.addEventListener("resize", setVelocity);
      image.style.position = "absolute";
      updatePosition();
    </script>
  </body>
</html>
